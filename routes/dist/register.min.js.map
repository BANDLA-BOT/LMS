{"version":3,"sources":["register.js"],"names":["router","require","Router","sendEmail","multer","storage","diskStorage","destination","cb","registerModel","filename","req","file","Date","originalname","upload","body","username","email","password","role","profile","user","save","res","json","message","_context","t0","module","exports"],"mappings":"aAAA,IAAMA,OAASC,QAAQ,WAAWC,SAC5BC,UAAYF,QAAQ,yBAEpBG,OAASH,QAAQ,mBAFGA,QAAA,kCAApBE,uBAAAA,cAOAE,QAAUD,OAAOE,YAAY,CACjCC,YALwBN,SAAAA,EAAAA,EAAQO,GAA1BC,EAAAA,KAAAA,mBAQNC,SAAU,SAACC,EAAKC,EAAMJ,GAJlBH,EAAAA,KAAOQ,KAAGT,MAAOE,IAAPM,EAAmBE,iBAAAC,OAAAX,OAAA,CAIjCM,QAAQL,UACNG,OAAG,WAILH,OAAAA,KAASA,IAAAA,OAAAA,SAAAA,EAAAA,GAAAA,IAAAA,EAAAA,EAAAA,EAAAA,EAAAA,EAAAA,EAAAA,EAAAA,EAAAA,OAAAA,mBAAAA,MAAAA,SAAAA,GAAAA,OAAAA,OAAAA,EAAAA,KAAAA,EAAAA,MAAAA,KAAAA,EAAAA,OAAAA,EAGXM,EAAAK,KAFUC,EADCZ,EACDY,SAFVC,EACWb,EADXa,MAIAC,EAHWd,EAGXc,SAAAC,EAHWf,EAGXe,KAIQC,EAAUV,EAAIC,KAAKS,QAPhBhB,EAAAA,KAAAA,EAUDiB,EAAO,IAAIb,cAAc,CALVS,MAAAA,EAAAD,SAAAA,EAAAE,SAAAA,EAAAC,KAAAA,EAAAC,QAAAA,IALdhB,EAAAA,KAAAA,EAAAA,mBAAAA,MAKciB,EAAAC,QALdlB,KAAAA,EAAAA,OAUDiB,EAVCjB,8CAAAA,OAUwBiB,EAAAF,KAVxBf,iCAAAA,OAYLY,EAAUA,MAZLZ,4BAAAA,OAaGiB,EAAEH,SAbLd,cAAAA,EAAAA,KAAAA,EAAAA,mBAAAA,MAeLgB,UAAOH,EAAEG,eAAAA,IAfJhB,KAAAA,EAUwBmB,EAAAC,KALV,CAAAC,QAAA,UAAAJ,KAAAA,IALdjB,EAAAA,KAAAA,GAAAA,MAAAA,KAAAA,GAAAA,EAAAA,KAAAA,GAAAA,EAAAA,GAAAA,EAAAA,MAAAA,GAKcmB,EAAAC,KAAA,CAAAC,QAAA,sBAYVH,MAALI,EAAAC,KAjBCvB,KAAAA,GAAAA,IAAAA,MAAAA,OAAAA,EAAAA,SAAAA,KAAAA,KAAAA,CAAAA,CAAAA,EAAAA,QAKcwB,OAAAC,QAAA9B","file":"register.min.js","sourcesContent":["const router = require(\"express\").Router();\r\nconst sendEmail = require(\"../config/sendmail.js\");\r\n// const path = require('path')\r\nconst multer = require(\"multer\");\r\nconst { registerModel } = require(\"../models/registrationModel.js\");\r\n\r\n//multer to upload\r\n\r\nconst storage = multer.diskStorage({\r\n  destination: (req, file, cb) => {\r\n    cb(null, \"public/profile\");\r\n  },\r\n  filename: (req, file, cb) => {\r\n    cb(null, Date.now() + \"-\" + file.originalname);\r\n  },\r\n});\r\nconst upload = multer({\r\n  storage: storage,\r\n}).single(\"profile\");\r\n\r\n//registration for Admin and Instructor\r\n\r\nrouter.post(\"/\", upload, async (req, res) => {\r\n  const { username, email, password, role } = req.body;\r\n  const profile = req.file.profile;\r\n\r\n  try {\r\n    const user = new registerModel({\r\n      email: email,\r\n      username: username,\r\n      password: password,\r\n      role: role,\r\n      profile: profile,\r\n    });\r\n    await user.save();\r\n    const text = `\r\n    <h1>Registered successfully as <span>${user.role}</span></h1>\r\n    <p>email:  ${user.email}</p>\r\n    <p>password:  ${user.password}</p>\r\n    `;\r\n    await sendEmail(email, \"Registration\", text);\r\n    res.json({ message: \"success\", user });\r\n  } catch (error) {\r\n    res.json({ message: \"Registration failed\", error });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"]}