{"version":3,"sources":["register.js"],"names":["router","require","Router","sendEmail","multer","storage","diskStorage","destination","cb","filename","registerModel","Date","now","file","originalname","upload","post","req","res","_req$body","username","email","password","role","profile","user","text","regeneratorRuntime","async","_context","prev","next","body","awrap","save","concat","json","message","t0","error","stop","module","exports"],"mappings":"aAAA,IAAMA,OAASC,QAAQ,WAAWC,SAC5BC,UAAYF,QAAQ,yBAEpBG,OAASH,QAAQ,mBAFGA,QAAA,kCAApBE,uBAAAA,cAKAE,QAAUD,OAAOE,YAAY,CAHnCC,YAAeN,SAAAA,EAAAA,EAAQO,GAKnBA,EAAG,KAAM,mBAEXC,SANMC,SAAAA,EAAAA,EAMaF,GACjBA,EAAG,KAAMG,KAAKC,MAAQ,IAAOC,EAAKC,iBAHhCC,OAAOX,OAAA,CACVC,QAHgCA,UAIjCI,OAAQ,WAEPT,OAAAgB,KAAA,IAAAD,OAAA,SAAAE,EAAAC,GAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAAA,OAAAZ,EANHF,EAAAe,KAAAZ,EAMGD,EANHC,SAAAC,EAMGF,EANHE,MAAAC,EAMGH,EANHG,SAAAC,EAMGJ,EANHI,KAQMR,EAAQX,EAAOS,KAAAW,QAFlBK,EAAAC,KAAA,EAMId,EAAUD,IAAAA,cAAQ,CAAAM,MAAAA,EAOnBD,SAAUA,EAPSE,SAAAA,EAAAC,KAAAA,EAAAC,QAAAA,IANtBK,EAAAE,KAAA,EAAAJ,mBAAAM,MAMsBR,EAAAS,QANtB,KAAA,EAAA,OAWOT,EAXP,8CAAAU,OAWgCV,EAAAF,KAXhC,iCAAAY,OAaGf,EAAUA,MAbb,4BAAAe,OAcWV,EAAEH,SAdb,cAAAO,EAAAE,KAAA,EAAAJ,mBAAAM,MAgBGT,UAAOH,EAACG,eAAAA,IAhBX,KAAA,EAWgCN,EAAAkB,KALV,CAAAC,QAAA,UAAAZ,KAAAA,IANtBI,EAAAE,KAAA,GAAA,MAAA,KAAA,GAAAF,EAAAC,KAAA,GAAAD,EAAAS,GAAAT,EAAA,MAAA,GA8BCX,EAAIkB,KAAK,CAACC,QAAQ,sBAAuBE,MAAKV,EAAAS,KA9B/C,KAAA,GAAA,IAAA,MAAA,OAAAT,EAAAW,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QAMsBC,OAAAC,QAAA1C","file":"register.min.js","sourcesContent":["const router = require(\"express\").Router();\r\nconst sendEmail = require(\"../config/sendmail.js\");\r\n// const path = require('path')\r\nconst multer = require('multer')\r\nconst { registerModel } = require(\"../models/registrationModel.js\");\r\n\r\nconst storage = multer.diskStorage({\r\n  destination:(req,file,cb)=>{\r\n    cb(null, 'public/profile')\r\n  },\r\n  filename:(req,file,cb)=>{\r\n    cb(null, Date.now() + '-' +  file.originalname)\r\n  }\r\n})\r\nconst upload =multer({\r\n  storage:storage\r\n}).single('profile')\r\n\r\nrouter.post(\"/\", upload, async(req, res) => {\r\n  const { username, email, password, role } = req.body;\r\n  const profile = req.file.profile\r\n\r\n  try {\r\n    const user = new registerModel({\r\n      email: email,\r\n      username: username,\r\n      password: password,\r\n      role: role,\r\n      profile:profile,\r\n    });\r\n    await user.save()\r\n\r\n\r\n    const text = `\r\n    <h1>Registered successfully as <span>${user.role}</span></h1>\r\n    <p>email:  ${user.email}</p>\r\n    <p>password:  ${user.password}</p>\r\n    `\r\n    await sendEmail(email, \"Registration\", text)\r\n    res.json({message:\"success\", user})\r\n    \r\n  } catch (error) {\r\n    res.json({message:\"Registration failed\", error})\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"]}